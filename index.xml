<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Narukine troubleshoot log</title><link>https://narukine.github.io/</link><description>Recent content on Narukine troubleshoot log</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sat, 25 Jun 2022 00:55:48 +0900</lastBuildDate><atom:link href="https://narukine.github.io/index.xml" rel="self" type="application/rss+xml"/><item><title>DLL Export 시 MFC / 표준 Windows Library 간의 CString 빌드 대한 주의점</title><link>https://narukine.github.io/posts/dllexport_cstring/</link><pubDate>Sat, 25 Jun 2022 00:55:48 +0900</pubDate><guid>https://narukine.github.io/posts/dllexport_cstring/</guid><description>구 버전의 호환을 위하여 MFC DLL로 작성된 클래스를 재 Wrapping 후 배포해야했다.
기존 라이브러리에는 표준 Windows 라이브러리로 설정하여 공유 MFC 사용 플래그를 꺼두었다. 그러나 구 버전 클래스 헤더에 CString을 사용하기 위하여 &amp;lt;atlstr.h&amp;gt;를 참조하여 CString을 사용했다. 빌드에는 이상이 없었으나, 구 프로그램에 라이브러리를 교체하고 재빌드 시에 링킹 에러가 발생했다.
발생 원인은 CString 클래스가 표준 Windows 라이브러리와 MFC 라이브러리간의 StrTrait 차이였다.
&amp;lt;atlstr.h&amp;gt;를 참조하고 표준 Windows 라이브러리로 빌드한 결과물에서는 아래의 클래스로 빌드 되었다.</description></item><item><title>setsockopt 함수 사용 시 주의점</title><link>https://narukine.github.io/posts/setsockopt/</link><pubDate>Sun, 19 Jun 2022 13:09:44 +0900</pubDate><guid>https://narukine.github.io/posts/setsockopt/</guid><description>해당 장비에 이더넷이 활성화 되어있는지 확인하기 위하여 해당 장비가 보내는 신호를 주기별로 받을 필요가 생겨서 소켓 옵션으로 SO_RCVTIMEO를 주어 일정 시간이 넘을 경우 비활성화 처리해야 하는 경우가 생겼다. 당연히 timeout이니 timeval_t가 옵션 인자로 들어갈 줄 알고 timeval_t 구조체를 사용하여 인자를 주었는데, 동작하지 않는 것이었다. 사용했던 코드는 아래와 같다.
timeval_t tv = {5, 0}; setsockopt(soc, SOL_SOCKET, SO_RCVTIMEO, reinterpret_cast&amp;lt;char*&amp;gt;(&amp;amp;tv), sizeof(tv)); 그러나 찾아보니 윈도우에서는 인자가 timeval_t가 아닌 DWORD로 ms단위로 지정하여 보내줘야 했던 것이었다.</description></item></channel></rss>